{"version":3,"file":"index.umd.js","sources":["../src/Hooks.js","../src/RouterContainer.js"],"sourcesContent":["import * as React from 'react';\nimport {\n  useContext,\n  useMemo,\n  useEffect,\n  useState\n} from 'react';\nimport {Router} from 'groutcho';\n\nconst RouterContext = React.createContext();\n\nfunction useRouter ({input, routes, redirects, web, onChange}) {\n  function getUrl () {\n    if (web) {\n      const {location} = window;\n      const {pathname, search} = location;\n      return `${pathname}${search}`;\n    } else {\n      return '/';\n    }\n  }\n\n  function setUrlAndPushState (url) {\n    setUrl(url);\n    if (web) {\n      window.history.pushState({}, '', url);\n    }\n  }\n\n  const [url, setUrl] = useState(getUrl());\n  const router = useMemo(()=> {\n    const router = new Router({routes, redirects});\n    router.onChange((new_url)=> {\n      if (new_url !== url) {\n        setUrlAndPushState(new_url);\n        if (onChange) {\n          onChange(url);\n        }\n      }\n    }, input);\n    return router;\n  });\n\n  useEffect(()=> {\n    if (!web) {\n      return ()=> {};\n    }\n\n    function onPopState () {\n      setUrl(url);\n    }\n\n    window.addEventListener('popstate', onPopState);\n    return ()=> {\n      window.removeEventListener('popstate', onPopState);\n    };\n  }, []);\n\n  const match = router.match({...input, url});\n  if (match.redirect) {\n    setUrlAndPushState(match.url);\n  }\n\n  return {\n    match,\n    router,\n    url\n  };\n}\n\nfunction useGo () {\n  const router = useContext(RouterContext);\n  return function go (args) {\n    return router.go(args);\n  };\n}\n\nexport {\n  RouterContext,\n  useRouter,\n  useGo\n};\n","import * as React from 'react';\nimport PropTypes from 'prop-types';\n\nimport {\n  RouterContext,\n  useRouter\n} from './Hooks';\n\nexport default function RouterContainer ({input, routes, redirects, children, web, onChange}) {\n  const {router, match} = useRouter({input, routes, redirects, web, onChange});\n  return (\n    <RouterContext.Provider value={router}>\n      {children({match})}\n    </RouterContext.Provider>\n  );\n}\n\nRouterContainer.propTypes = {\n  input: PropTypes.object,\n  routes: PropTypes.object,\n  redirects: PropTypes.object,\n  web: PropTypes.bool,\n  children: PropTypes.func,\n  onChange: PropTypes.func\n};\n"],"names":["RouterContext","React","useRouter","input","routes","redirects","web","onChange","getUrl","location","window","pathname","search","setUrlAndPushState","url","setUrl","history","pushState","useState","router","useMemo","Router","new_url","useEffect","onPopState","addEventListener","removeEventListener","match","redirect","useGo","useContext","go","args","RouterContainer","children","React.createElement","propTypes","PropTypes","object","bool","func"],"mappings":"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"}