{"version":3,"file":"index.esm.js","sources":["../src/Hooks.js","../src/RouterContainer.js"],"sourcesContent":["import * as React from 'react';\nimport {\n  useContext,\n  useMemo,\n  useEffect,\n  useState\n} from 'react';\nimport {Router} from 'groutcho';\n\nconst RouterContext = React.createContext();\n\nfunction useRouter ({input, routes, redirects, web, onGo}) {\n  function getUrl () {\n    if (web) {\n      const {location} = window;\n      const {pathname, search} = location;\n      return `${pathname}${search}`;\n    } else {\n      return '/';\n    }\n  }\n\n  function setUrlAndPushState (url) {\n    setUrl(url);\n    if (web) {\n      window.history.pushState({}, '', url);\n    }\n  }\n\n  const [url, setUrl] = useState(getUrl());\n  const router = useMemo(()=> {\n    const router = new Router({routes, redirects});\n    router.onGo((new_url)=> {\n      if (new_url !== url) {\n        setUrlAndPushState(new_url);\n        if (onGo) {\n          onGo(url);\n        }\n      }\n    }, input);\n    return router;\n  });\n\n  useEffect(()=> {\n    if (!web) {\n      return ()=> {};\n    }\n\n    function onPopState () {\n      setUrl(url);\n    }\n\n    window.addEventListener('popstate', onPopState);\n    return ()=> {\n      window.removeEventListener('popstate', onPopState);\n    };\n  }, []);\n\n  const match = router.match({...input, url});\n  if (match.redirect) {\n    setUrlAndPushState(match.url);\n  }\n\n  return {\n    match,\n    router,\n    url\n  };\n}\n\nfunction useGo () {\n  const router = useContext(RouterContext);\n  return function go (args) {\n    return router.go(args);\n  };\n}\n\nexport {\n  RouterContext,\n  useRouter,\n  useGo\n};\n","import * as React from 'react';\nimport PropTypes from 'prop-types';\n\nimport {\n  RouterContext,\n  useRouter\n} from './Hooks';\n\nexport default function RouterContainer ({input, routes, redirects, children, web, onGo}) {\n  const {router, match} = useRouter({input, routes, redirects, web, onGo});\n  return (\n    <RouterContext.Provider value={router}>\n      {children({match})}\n    </RouterContext.Provider>\n  );\n}\n\nRouterContainer.propTypes = {\n  input: PropTypes.object,\n  routes: PropTypes.object,\n  redirects: PropTypes.object,\n  web: PropTypes.bool,\n  children: PropTypes.func,\n  onGo: PropTypes.func\n};\n"],"names":["RouterContext","React","useRouter","input","routes","redirects","web","onGo","getUrl","location","window","pathname","search","setUrlAndPushState","url","setUrl","history","pushState","useState","router","useMemo","Router","new_url","useEffect","onPopState","addEventListener","removeEventListener","match","redirect","useGo","useContext","go","args","RouterContainer","children","React.createElement","propTypes","PropTypes","object","bool","func"],"mappings":"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"}